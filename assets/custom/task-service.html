<link rel="import" href="/static/components/polymer/polymer.html">
<link rel="import" href="/static/components/core-ajax/core-ajax.html">
<link rel="import" href="/static/custom/set-tasks.html">

<polymer-element name="task-service" attributes="tasks">
    <template>
        <style>
            :host {
                display: none;
            }
        </style>
        <core-ajax id="getTasks"
                   auto
                   method="get"
                   url="/today/"
                   on-core-response="{{ tasksLoaded }}"
                   response="{{ tasks }}"
                   handleAs="json">
        </core-ajax>
        <core-ajax id="postTasks"
                   auto
                   method="post"
                   url="/today/"
                   on-core-response="{{ postSuccess }}"
                   on-core-error=""
                   response="{{ tasks }}"
                   body="{{ tasks }}"
                   handleAs="json">
        </core-ajax>
    </template>
    <script>
        Polymer('task-service', {
            created: function () {
                this.tasks = [];
            },
            tasksLoaded: function () {
                // Make a copy of the loaded data
            },
            updateTasks: function () {
                //this.
            },
            postSuccess: function () {
                console.log(this.tasks)
            },
            /**
             * Update the service with the current favorite value.
             * (Two-way data binding updates the favorite value
             * stored locally.) If this was a real service, this
             * method would do something useful.
             *
             * @method setFavorite
             * @param uid {Number} Unique ID for post.
             * @param isFavorite {Boolean} True if the user marked this post as a favorite.
             */
            setFavorite: function (uid, isFavorite) {
                // no service backend, just log the change
                console.log('Favorite changed: ' + uid + ", now: " + isFavorite);
            }
        });
    </script>
</polymer-element>